<div class="admin-card">
  <h2>üéÆ Game Events Management</h2>

  <% if params[:error] %>
    <div class="alert alert-danger" style="margin-bottom: 1rem;">
      <strong>‚ùå Error:</strong> <%= params[:error] %>
    </div>
  <% end %>

  <div style="margin-bottom: 1rem;">
    <%= form_with url: admin_game_events_path, method: :get, local: true do |form| %>
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 1rem; align-items: end;">
        <div class="form-group">
          <%= form.label :game_name, "Filter by Game" %>
          <%= form.select :game_name,
              options_for_select([["All Games", ""]] + @available_games.map { |g| [g, g] }, params[:game_name]),
              {},
              class: "form-control" %>
        </div>

        <div class="form-group">
          <%= form.label :user_id, "Filter by User" %>
          <%= form.select :user_id,
              options_for_select([["All Users", ""]] + @available_users.map { |u| [u.email, u.id] }, params[:user_id]),
              {},
              class: "form-control" %>
        </div>

        <div>
          <%= form.submit "Filter", class: "btn btn-primary" %>
          <%= link_to "Clear", admin_game_events_path, class: "btn btn-secondary" %>
        </div>
      </div>
    <% end %>
  </div>

  <%= link_to "‚ûï New Game Event", new_admin_game_event_path, class: "btn btn-primary", style: "margin-bottom: 1rem;" %>

  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>User</th>
        <th>Game</th>
        <th>Event Type</th>
        <th>Occurred At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @game_events.each do |event| %>
        <tr>
          <td><%= event.id %></td>
          <td><%= event.user.email %></td>
          <td><%= event.game_name %></td>
          <td><%= event.event_type %></td>
          <td><%= event.occurred_at.strftime("%Y-%m-%d %H:%M") %></td>
          <td style="white-space: nowrap; display: flex; gap: 0.25rem; align-items: center;">
            <%= link_to "üëÅÔ∏è View", admin_game_event_path(event), class: "btn btn-secondary btn-sm" %>
            <%= link_to "‚úèÔ∏è Edit", edit_admin_game_event_path(event), class: "btn btn-secondary btn-sm" %>
            <%= form_with url: admin_game_event_path(event), method: :post, local: true, style: "display: inline;" do |form| %>
              <%= form.submit "üóëÔ∏è",
                  class: "btn btn-outline-danger btn-sm",
                  title: "Delete game event",
                  data: { confirm: "Are you sure you want to delete this game event?" } %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <% if @game_events.respond_to?(:current_page) %>
    <div style="text-align: center; margin-top: 1rem;">
      <%= paginate @game_events %>
    </div>
  <% end %>
</div>
